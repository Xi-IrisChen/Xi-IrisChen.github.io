<!doctype html>
<html lang="en" class="force-cursor">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Playground · Framed Nature</title>
    
    <!-- Ensure custom cursor re-applies on refresh/tab focus -->
    <script>
      (function ensureCursorPaints() {
        const root = document.documentElement;
        function refreshCursor() {
          root.classList.remove('force-cursor');
          void root.offsetHeight; // force style recalc / repaint
          root.classList.add('force-cursor');
        }
        root.classList.add('force-cursor');
        window.addEventListener('pageshow', refreshCursor);
        window.addEventListener('focus', refreshCursor);
        document.addEventListener('visibilitychange', () => {
          if (!document.hidden) refreshCursor();
        });
      })();
    </script>
    
    <style>
      /* ───────────────────────────────────────────────
         Firefly Glow Cursor
         ─────────────────────────────────────────────── */
      html.force-cursor,
      html.force-cursor * {
        cursor: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Cdefs%3E%3CradialGradient id='fireflyGlow'%3E%3Cstop offset='0%25' style='stop-color:rgb(255,248,220);stop-opacity:1'/%3E%3Cstop offset='25%25' style='stop-color:rgb(255,215,100);stop-opacity:0.9'/%3E%3Cstop offset='50%25' style='stop-color:rgb(255,180,50);stop-opacity:0.5'/%3E%3Cstop offset='100%25' style='stop-color:rgb(200,140,20);stop-opacity:0'/%3E%3C/radialGradient%3E%3C/defs%3E%3Ccircle cx='20' cy='20' r='16' fill='url(%23fireflyGlow)'/%3E%3Ccircle cx='20' cy='20' r='4' fill='rgb(255,252,240)' opacity='1'/%3E%3C/svg%3E") 20 20, auto !important;
      }
      
      /* Firefly trail canvas */
      #fireflyTrailCanvas {
        position: fixed;
        inset: 0;
        width: 100vw;
        height: 100vh;
        z-index: 9998;
        pointer-events: none;
      }
      /* Register custom properties for smooth color transitions */
      @property --bg-center {
        syntax: '<color>';
        inherits: true;
        initial-value: #202F08;
      }
      
      @property --bg-edge {
        syntax: '<color>';
        inherits: true;
        initial-value: #121A02;
      }
      
      @property --vignette {
        syntax: '<color>';
        inherits: true;
        initial-value: rgba(18, 26, 2, 0.75);
      }

      /* ───────────────────────────────────────────────
         Light mode (default)
         ─────────────────────────────────────────────── */
      :root {
        --bg-center: #202F08;
        --bg-edge: #121A02;
        --vignette: rgba(18, 26, 2, 0.75);
        --wood: linear-gradient(
          135deg,
          #d9c4a5 0%,
          #e2d1b5 18%,
          #cdb78f 40%,
          #dcc9a8 60%,
          #c9b48a 82%,
          #d4c09a 100%
        );
        --wood-shadow: 0 28px 60px rgba(40, 50, 35, 0.38),
                       0 8px 20px rgba(30, 40, 25, 0.22);
        --frame-border: rgba(180, 160, 120, 0.6);
        
        /* Smooth transition for background colors */
        transition: --bg-center 0.8s ease-in-out, 
                    --bg-edge 0.8s ease-in-out,
                    --vignette 0.8s ease-in-out;
      }

      /* ───────────────────────────────────────────────
         Dark mode
         ─────────────────────────────────────────────── */
      @media (prefers-color-scheme: dark) {
        :root {
          --bg-center: #2a3a2a;
          --bg-edge: #0e1610;
          --vignette: rgba(0, 0, 0, 0.55);
          --wood: linear-gradient(
            135deg,
            #c4a87a 0%,
            #d4bb92 18%,
            #b89e6c 40%,
            #ccb588 60%,
            #b49a68 82%,
            #c2a878 100%
          );
          --wood-shadow: 0 32px 80px rgba(0, 0, 0, 0.6),
                         0 10px 28px rgba(0, 0, 0, 0.4);
          --frame-border: rgba(200, 180, 140, 0.6);
        }
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      html,
      body {
        height: 100%;
        overflow: hidden;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Helvetica, Arial, sans-serif;
        background: 
          radial-gradient(
            ellipse 100% 90% at 35% 45%,
            var(--bg-center),
            var(--bg-edge) 70%
          );
      }

      /* Soft vignette overlay with depth */
      body::before {
        content: "";
        position: fixed;
        inset: 0;
        pointer-events: none;
        z-index: 0;
        background: 
          radial-gradient(
            ellipse 85% 75% at 38% 42%,
            transparent 25%,
            var(--vignette) 90%
          ),
          radial-gradient(
            circle at 85% 50%,
            rgba(5, 15, 10, 0.4) 0%,
            transparent 45%
          );
      }

      /* ───────────────────────────────────────────────
         Animated fog layers (rainforest atmosphere)
         ─────────────────────────────────────────────── */
      .fog {
        position: fixed;
        inset: 0;
        pointer-events: none;
        z-index: 1;
        overflow: hidden;
      }

      .fog-layer {
        position: absolute;
        width: 200%;
        height: 200%;
        top: -50%;
        left: -50%;
      }

      /* Layer 1: Small drifting mist from bottom-left */
      .fog-1 {
        background: 
          radial-gradient(ellipse 18% 15% at 30% 70%, rgba(90, 130, 110, 0.45), transparent 70%);
        filter: blur(50px);
        animation: fogDrift1 25s ease-in-out infinite;
      }

      /* Layer 2: Small mist from top-right */
      .fog-2 {
        background: 
          radial-gradient(ellipse 15% 12% at 70% 25%, rgba(70, 110, 90, 0.38), transparent 65%);
        filter: blur(45px);
        animation: fogDrift2 32s ease-in-out infinite;
      }

      /* Layer 3: Subtle rising mist */
      .fog-3 {
        background: 
          radial-gradient(ellipse 20% 12% at 50% 85%, rgba(100, 140, 120, 0.4), transparent 60%);
        filter: blur(60px);
        animation: fogDrift3 20s ease-in-out infinite;
      }

      /* Layer 4: Soft light from above */
      .fog-4 {
        background: 
          radial-gradient(ellipse 15% 20% at 45% 10%, rgba(120, 150, 135, 0.42), transparent 70%);
        filter: blur(35px);
        animation: lightShift 18s ease-in-out infinite;
      }

      @keyframes fogDrift1 {
        0%, 100% { transform: translate(0%, 0%); }
        50% { transform: translate(30%, -45%); }
      }

      @keyframes fogDrift2 {
        0%, 100% { transform: translate(0%, 0%); }
        50% { transform: translate(-48%, 22%); }
      }

      @keyframes fogDrift3 {
        0%, 100% { transform: translate(0%, 5%); opacity: 0.6; }
        50% { transform: translate(0%, -35%); opacity: 1; }
      }

      @keyframes lightShift {
        0%, 100% { transform: translate(-15%, 0%); opacity: 0.5; }
        50% { transform: translate(35%, 0%); opacity: 0.9; }
      }

      @media (prefers-reduced-motion: reduce) {
        .fog-layer {
          animation: none;
        }
      }

      /* ───────────────────────────────────────────────
         Vignette overlay
         ─────────────────────────────────────────────── */
      .vignette {
        position: fixed;
        inset: 0;
        pointer-events: none;
        z-index: 3;
        background: radial-gradient(circle at center, rgba(0,0,0,0) 40%, rgba(0,0,0,0.35) 100%);
      }

      /* ───────────────────────────────────────────────
         Subtle grain overlay (CSS noise)
         ─────────────────────────────────────────────── */
      .grain {
        position: fixed;
        inset: 0;
        pointer-events: none;
        z-index: 4;
        opacity: 0.10;
        background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
        background-repeat: repeat;
        background-size: 180px 180px;
      }

      .stage {
        position: relative;
        z-index: 5;
        height: 100%;
        width: 100%;
        display: grid;
        place-items: center;
      }

      /* Wood frame */
      .frame {
        position: relative;
        width: min(72vw, 360px);
        aspect-ratio: 9 / 16;
        padding: 20px;
        border-radius: 8px;
        background: url('assets/2026/nature/frame.png');
        background-size: cover;
        background-position: center;
        box-shadow: var(--wood-shadow);
        transform: translateZ(0);
      }

      /* Remove the artificial grain overlay since we have real wood texture now */
      .frame::before {
        display: none;
      }

      .inner {
        width: 100%;
        height: 100%;
        overflow: hidden;
        border-radius: 2px;
        background: #111;
        position: relative;
      }

      video, img.media-item {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
        position: absolute;
        top: 0;
        left: 0;
        transition: opacity 0.8s ease-in-out;
      }

      video.active, img.media-item.active {
        opacity: 1;
        z-index: 2;
      }

      video.inactive, img.media-item.inactive {
        opacity: 0;
        z-index: 1;
      }

      /* Zoom-in animation for static images */
      @keyframes slowZoomIn {
        0% {
          transform: scale(1);
        }
        100% {
          transform: scale(1.1);
        }
      }

      img.media-item.active {
        animation: slowZoomIn 5s ease-in-out infinite alternate;
      }

      @keyframes float {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-6px);
        }
      }

      @media (prefers-reduced-motion: reduce) {
        .frame {
          animation: none;
        }
      }

      /* ───────────────────────────────────────────────
         Home button
         ─────────────────────────────────────────────── */
      .home-button {
        position: fixed;
        top: 60px;
        left: 60px;
        z-index: 1000;
        width: 24px;
        height: 24px;
        cursor: pointer;
        border: none;
        background: none;
        padding: 0;
        transition: all 0.3s ease;
        display: block;
      }

      .home-button img {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: block;
        transition: opacity 0.3s ease;
      }

      .home-button .home-default {
        opacity: 1;
      }

      .home-button .home-hover {
        opacity: 0;
      }

      .home-button:hover .home-default {
        opacity: 0;
      }

      .home-button:hover .home-hover {
        opacity: 1;
      }

      .home-button:active {
        transform: scale(0.95);
      }

      /* ───────────────────────────────────────────────
         Audio control button
         ─────────────────────────────────────────────── */
      .audio-control {
        position: fixed;
        bottom: 60px;
        right: 60px;
        z-index: 1000;
        width: 24px;
        height: 24px;
        cursor: pointer;
        border: none;
        background: none;
        padding: 0;
        transition: all 0.3s ease;
      }

      .audio-control img {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: block;
        transition: opacity 0.3s ease;
      }

      .audio-control .volume-default {
        opacity: 1;
      }

      .audio-control .volume-hover {
        opacity: 0;
      }

      .audio-control:hover .volume-default {
        opacity: 0;
      }

      .audio-control:hover .volume-hover {
        opacity: 1;
      }

      .audio-control:active {
        transform: scale(0.95);
      }

      /* Hide volume-off by default, show volume-on */
      .audio-control .volume-off {
        display: none;
      }

      /* When muted, hide volume-on and show volume-off */
      .audio-control.muted .volume-on {
        display: none;
      }

      .audio-control.muted .volume-off {
        display: block;
      }

      /* ───────────────────────────────────────────────
         Entrance overlay
         ─────────────────────────────────────────────── */
      .entrance-overlay {
        position: fixed;
        inset: 0;
        z-index: 9999;
        background: #000000;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        opacity: 1;
        transition: opacity 1s ease-in-out;
      }

      .entrance-overlay.hidden {
        opacity: 0;
        pointer-events: none;
      }

      .entrance-text {
        text-align: center;
        color: rgba(255, 255, 255, 0.7);
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Helvetica, Arial, sans-serif;
        animation: fadeInUp 1.2s ease-out;
      }

      .entrance-text p {
        font-size: 18px;
        line-height: 1.6;
        font-weight: 400;
        margin: 0;
      }

      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @media (prefers-reduced-motion: reduce) {
        .entrance-text {
          animation: none;
        }
      }
    </style>
  </head>
  <body>
    <!-- Entrance overlay -->
    <div class="entrance-overlay" id="entranceOverlay">
      <div class="entrance-text">
        <p>Enter nature.</p>
        <p>Harmony within.</p>
      </div>
    </div>

    <!-- Firefly trail canvas -->
    <canvas id="fireflyTrailCanvas" aria-hidden="true"></canvas>

    <!-- Animated fog layers -->
    <div class="fog" aria-hidden="true">
      <div class="fog-layer fog-1"></div>
      <div class="fog-layer fog-2"></div>
      <div class="fog-layer fog-3"></div>
      <div class="fog-layer fog-4"></div>
    </div>

    <!-- Vignette overlay -->
    <div class="vignette" aria-hidden="true"></div>

    <!-- Grain overlay -->
    <div class="grain" aria-hidden="true"></div>

    <!-- Home button -->
    <a href="index.html" class="home-button" aria-label="Back to home" title="Back to home">
      <img src="assets/2026/icon/home.png" alt="Home" class="home-default">
      <img src="assets/2026/icon/home_hover.png" alt="Home" class="home-hover">
    </a>

    <main class="stage">
      <section class="frame">
        <div class="inner">
          <video
            id="video1"
            class="active"
            src="assets/2026/nature/1.MOV"
            autoplay
            muted
            loop
            playsinline
          ></video>
          <video
            id="video2"
            class="inactive"
            src="assets/2026/nature/2.MOV"
            muted
            loop
            playsinline
          ></video>
          <img
            id="image1"
            class="media-item inactive"
            src="assets/2026/nature/5.JPG"
            alt="Nature scene"
          >
        </div>
      </section>
    </main>

    <!-- Background music -->
    <audio id="bgMusic" loop>
      <source src="assets/2026/nature/forest.wav" type="audio/wav">
    </audio>

    <!-- Audio control button -->
    <button 
      id="audioControl" 
      class="audio-control muted" 
      aria-label="Toggle background music"
      title="Toggle background music"
    >
      <img src="assets/2026/icon/volume-on.png" alt="Volume on" class="volume-on volume-default">
      <img src="assets/2026/icon/volume-on_hover.png" alt="Volume on" class="volume-on volume-hover">
      <img src="assets/2026/icon/volume-off.png" alt="Volume off" class="volume-off volume-default">
      <img src="assets/2026/icon/volume-off_hover.png" alt="Volume off" class="volume-off volume-hover">
    </button>

    <script>
      // ─────────────────────────────────────────────────────
      // Entrance overlay - auto fade after 4 seconds
      // ─────────────────────────────────────────────────────
      const entranceOverlay = document.getElementById('entranceOverlay');
      let entranceComplete = false;
      
      setTimeout(() => {
        entranceOverlay.classList.add('hidden');
        // Mark entrance as complete after fade transition
        setTimeout(() => {
          entranceComplete = true;
        }, 1000); // Wait for 1s fade transition to complete
      }, 4000);

      // ─────────────────────────────────────────────────────
      // Media switching setup (videos and images)
      // ─────────────────────────────────────────────────────
      const mediaItems = [
        { type: 'video', src: 'assets/2026/nature/1.MOV' },
        { type: 'video', src: 'assets/2026/nature/2.MOV' },
        { type: 'video', src: 'assets/2026/nature/3.MOV' },
        { type: 'video', src: 'assets/2026/nature/4.MOV' },
        { type: 'image', src: 'assets/2026/nature/5.JPG' }
      ];
      
      // Color palettes for each video
      const colorPalettes = [
        {
          center: '#202F08',
          edge: '#121A02',
          vignette: 'rgba(18, 26, 2, 0.75)'
        },
        {
          center: '#486893',
          edge: '#0A182B',
          vignette: 'rgba(10, 24, 43, 0.75)'
        },
        {
          center: '#44522B',
          edge: '#141D02',
          vignette: 'rgba(20, 29, 2, 0.75)'
        },
        {
          center: '#4B5505',
          edge: '#171E01',
          vignette: 'rgba(23, 30, 1, 0.75)'
        },
        {
          center: '#6B580F',
          edge: '#2A2200',
          vignette: 'rgba(42, 34, 0, 0.75)'
        }
      ];
      
      const video1 = document.getElementById('video1');
      const video2 = document.getElementById('video2');
      const image1 = document.getElementById('image1');
      let currentMediaIndex = 0;
      let isTransitioning = false;
      let activeElement = video1;
      let inactiveVideo = video2;

      // Function to update background colors
      function updateBackgroundColors(index) {
        const palette = colorPalettes[index];
        const root = document.documentElement;
        root.style.setProperty('--bg-center', palette.center);
        root.style.setProperty('--bg-edge', palette.edge);
        root.style.setProperty('--vignette', palette.vignette);
      }

      // ─────────────────────────────────────────────────────
      // Scroll handling with smooth transitions
      // ─────────────────────────────────────────────────────
      let scrollCooldown = false;
      const cooldownTime = 2000; // 1 second between transitions

      function switchToNextVideo() {
        if (isTransitioning || scrollCooldown) return;
        
        isTransitioning = true;
        scrollCooldown = true;

        // Determine next media index
        const nextIndex = (currentMediaIndex + 1) % mediaItems.length;
        const nextMedia = mediaItems[nextIndex];
        
        // Update background colors
        updateBackgroundColors(nextIndex);
        
        let nextElement;
        
        // Prepare the next media element
        if (nextMedia.type === 'image') {
          nextElement = image1;
          nextElement.src = nextMedia.src;
        } else {
          // Use the inactive video element
          nextElement = inactiveVideo;
          nextElement.src = nextMedia.src;
          nextElement.currentTime = 0;
          nextElement.play();
        }

        // Start crossfade animation
        setTimeout(() => {
          activeElement.classList.remove('active');
          activeElement.classList.add('inactive');
          nextElement.classList.remove('inactive');
          nextElement.classList.add('active');

          // Update references
          if (nextMedia.type === 'video') {
            // If we're switching to a video, swap the inactive video reference
            if (activeElement === video1 || activeElement === video2) {
              const temp = activeElement;
              inactiveVideo = temp;
            } else {
              // Previous was an image, so inactiveVideo stays the same
            }
          }
          
          activeElement = nextElement;
          currentMediaIndex = nextIndex;
          
          // End transition after animation completes
          setTimeout(() => {
            isTransitioning = false;
          }, 800); // Match the CSS transition duration
        }, 50);

        // Reset cooldown
        setTimeout(() => {
          scrollCooldown = false;
        }, cooldownTime);
      }

      function switchToPrevVideo() {
        if (isTransitioning || scrollCooldown) return;
        
        isTransitioning = true;
        scrollCooldown = true;

        // Determine previous media index
        const prevIndex = (currentMediaIndex - 1 + mediaItems.length) % mediaItems.length;
        const prevMedia = mediaItems[prevIndex];
        
        // Update background colors
        updateBackgroundColors(prevIndex);
        
        let prevElement;
        
        // Prepare the previous media element
        if (prevMedia.type === 'image') {
          prevElement = image1;
          prevElement.src = prevMedia.src;
        } else {
          // Use the inactive video element
          prevElement = inactiveVideo;
          prevElement.src = prevMedia.src;
          prevElement.currentTime = 0;
          prevElement.play();
        }

        // Start crossfade animation
        setTimeout(() => {
          activeElement.classList.remove('active');
          activeElement.classList.add('inactive');
          prevElement.classList.remove('inactive');
          prevElement.classList.add('active');

          // Update references
          if (prevMedia.type === 'video') {
            // If we're switching to a video, swap the inactive video reference
            if (activeElement === video1 || activeElement === video2) {
              const temp = activeElement;
              inactiveVideo = temp;
            }
          }
          
          activeElement = prevElement;
          currentMediaIndex = prevIndex;
          
          // End transition after animation completes
          setTimeout(() => {
            isTransitioning = false;
          }, 800); // Match the CSS transition duration
        }, 50);

        // Reset cooldown
        setTimeout(() => {
          scrollCooldown = false;
        }, cooldownTime);
      }

      // Listen for wheel events (mouse scroll)
      let scrollAccumulator = 0;
      const scrollThreshold = 100; // Pixels needed to trigger transition

      window.addEventListener('wheel', (e) => {
        if (isTransitioning || scrollCooldown) return;

        scrollAccumulator += e.deltaY;

        if (Math.abs(scrollAccumulator) >= scrollThreshold) {
          if (scrollAccumulator > 0) {
            // Scrolling down - next video
            switchToNextVideo();
          } else {
            // Scrolling up - previous video
            switchToPrevVideo();
          }
          scrollAccumulator = 0;
        }
      }, { passive: true });

      // ─────────────────────────────────────────────────────
      // Audio control setup with auto-play and fade-in
      // ─────────────────────────────────────────────────────
      const audio = document.getElementById('bgMusic');
      const audioControl = document.getElementById('audioControl');
      let isPlaying = false;
      let audioStarted = false;

      // Start with volume at 0, will fade in later
      audio.volume = 0;

      // Start audio immediately (user clicked to get here, so autoplay is allowed)
      audio.play().then(() => {
        isPlaying = true;
        audioStarted = true;
        
        // After 4 seconds (when entrance starts fading), fade in the volume
        setTimeout(() => {
          fadeInAudio();
        }, 4000);
      }).catch(err => {
        console.log('Audio autoplay failed:', err);
        // Fallback: try on user interaction
        document.body.addEventListener('click', () => {
          if (!audioStarted) {
            audio.play().then(() => {
              isPlaying = true;
              audioStarted = true;
              fadeInAudio();
            });
          }
        }, { once: true });
      });

      // Fade in audio volume from 0 to 0.25 over 1 second
      function fadeInAudio() {
        const targetVolume = 0.25;
        const fadeInDuration = 1000; // 1 second
        const steps = 50;
        const volumeStep = targetVolume / steps;
        const timeStep = fadeInDuration / steps;
        
        let currentStep = 0;
        const fadeInterval = setInterval(() => {
          currentStep++;
          audio.volume = Math.min(volumeStep * currentStep, targetVolume);
          
          if (currentStep >= steps) {
            clearInterval(fadeInterval);
            audio.volume = targetVolume;
            audioControl.classList.remove('muted');
          }
        }, timeStep);
      }

      // Toggle audio on button click
      audioControl.addEventListener('click', (e) => {
        e.stopPropagation(); // Prevent triggering the body click listener
        if (isPlaying) {
          audio.pause();
          audioControl.classList.add('muted');
          isPlaying = false;
        } else {
          // Restore volume if it was muted
          if (audio.volume === 0) {
            audio.volume = 0.25;
          }
          audio.play().then(() => {
            audioControl.classList.remove('muted');
            isPlaying = true;
            audioStarted = true;
          }).catch(err => {
            console.error('Error playing audio:', err);
          });
        }
      });

      // Handle when audio actually starts playing
      audio.addEventListener('play', () => {
        isPlaying = true;
        // Only show as unmuted if volume is audible
        if (audio.volume > 0.05) {
          audioControl.classList.remove('muted');
        }
      });

      // Handle when audio is paused
      audio.addEventListener('pause', () => {
        audioControl.classList.add('muted');
        isPlaying = false;
      });
    </script>

    <!-- Firefly trail effect -->
    <script>
      (function initFireflyTrail() {
        const prefersReducedMotion = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
        if (prefersReducedMotion) return;

        const canvas = document.getElementById('fireflyTrailCanvas');
        if (!canvas) return;

        const ctx = canvas.getContext('2d', { alpha: true });
        if (!ctx) return;

        const state = {
          w: 0,
          h: 0,
          dpr: 1,
          mouse: { x: 0, y: 0, active: false, lastMoveAt: 0 },
          trail: [],
          raf: 0,
          lastT: 0
        };

        function resize() {
          const dpr = Math.min(2, window.devicePixelRatio || 1);
          state.dpr = dpr;
          state.w = window.innerWidth;
          state.h = window.innerHeight;
          canvas.width = Math.floor(state.w * dpr);
          canvas.height = Math.floor(state.h * dpr);
          ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
        }

        function onPointerMove(e) {
          state.mouse.x = e.clientX;
          state.mouse.y = e.clientY;
          state.mouse.active = true;
          state.mouse.lastMoveAt = performance.now();
        }

        function draw(t) {
          const dt = state.lastT ? Math.min(0.05, (t - state.lastT) / 1000) : 0.016;
          state.lastT = t;

          ctx.clearRect(0, 0, state.w, state.h);

          if (state.mouse.active) {
            const sinceMove = t - state.mouse.lastMoveAt;
            const isMoving = sinceMove < 150;

            // Add new trail points when moving
            if (isMoving && state.trail.length === 0 || 
                (isMoving && state.trail.length > 0)) {
              const lastPoint = state.trail[state.trail.length - 1];
              const dist = lastPoint 
                ? Math.hypot(state.mouse.x - lastPoint.x, state.mouse.y - lastPoint.y)
                : 999;
              
              if (dist > 3) {
                state.trail.push({
                  x: state.mouse.x,
                  y: state.mouse.y,
                  t: t,
                  size: 2 + Math.random() * 1.5
                });
              }
            }

            // Remove old trail points (fade after 400ms)
            const cutoff = t - 400;
            while (state.trail.length && state.trail[0].t < cutoff) {
              state.trail.shift();
            }

            // Draw trail
            if (state.trail.length > 1) {
              ctx.save();
              ctx.globalCompositeOperation = 'lighter';

              for (let i = 0; i < state.trail.length; i++) {
                const point = state.trail[i];
                const age = (t - point.t) / 400; // 0 to 1
                const alpha = (1 - age) * 0.10; // Very subtle: max 0.25 opacity
                const size = point.size * (1 - age * 0.5);

                // Warm amber/golden glow
                const gradient = ctx.createRadialGradient(
                  point.x, point.y, 0,
                  point.x, point.y, size * 3
                );
                gradient.addColorStop(0, `rgba(255, 240, 180, ${alpha})`);
                gradient.addColorStop(0.4, `rgba(255, 200, 100, ${alpha * 0.6})`);
                gradient.addColorStop(1, `rgba(200, 150, 50, 0)`);

                ctx.beginPath();
                ctx.arc(point.x, point.y, size * 3, 0, Math.PI * 2);
                ctx.fillStyle = gradient;
                ctx.fill();
              }

              ctx.restore();
            }
          }

          state.raf = requestAnimationFrame(draw);
        }

        resize();
        window.addEventListener('resize', resize, { passive: true });
        window.addEventListener('pointermove', onPointerMove, { passive: true });
        state.raf = requestAnimationFrame(draw);
      })();
    </script>
  </body>
</html>
